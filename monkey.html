<h1 id="monkey-typing-abracadabra">Monkey typing ABRACADABRA</h1>
<p>Since I decided to call this blog <em>martingalemeasure</em> it seems only fitting that the first post should be about probability; martingales in particular. In my favorite introductory book on measue theoretical probability, &quot;Probablity with Martingales&quot; by David Williams, we find an exercise in Chapter 10. Which I paraphrase here.</p>
<pre><code>Suppose a monkey is typing randomly at a typewriter whose only keys are the
capital letters A through Z of the english alphabet. What is the
expected (average) time it will take for the monkey to type the word
ABRACADABRA?</code></pre>
<p>This is not an easy problem! Williams expects the reader to solve it using the beautiful theory of martingales and in particular <em>Doobs stopping theorem</em>. And we will do so below (albeit without proof). But, the purpose of this blog post is to try to provide some intuition about the result. By comparing the expected time it takes for the monkey to type ABRACADABRA with the expected time it takes to type the first eleven letters of the alphabet ABCDEFGHIJK.</p>
<h2 id="simplification">Simplification</h2>
<p>It's almost always a good idea when trying to solve a problem to first attack the simplest case you can think of that still emodies the essence of the problem. For our problem we can certainly benefit both from picking shorter words, and by choosing a small alphabet. The important distinction between &quot;ABRACADABRA&quot; and ABCDEFGHIJK is that the former starts to repeat at charcter 8. So if we look at ABA vs ABC we have a much shorter word. We might as well restrict our alphabet to A, B, C, while we are at it.</p>
<h2 id="solution">Solution</h2>
<p>Ok, let's use martingale theory to solve the simplified problem and then apply the result to the bigger problem. As is often the case in probability theory we will think it terms of gamblers making bets. Suppose that just before each keystroke that the monkey takes a new gambler shows up at a casino and employs the following betting strategy. She wagers one dollar that the monkey will type the first letter in the word, A. If she wins our imaginary casino pays her fair odds and she receives 3 dollars. She then bets the entire 3 dollars that the next keystroke will be the second letter, B. She continues until she has lost her intial dollar or the word is typed in full. In that case she wins 27 dollars, for a profit of 26. Each individaul bet is a fair bet, that is she has a $latex \frac{1}{3}$rd chance of tripling her wager, say $$latex x$ for profit of $latex \2x$ and a $latex \frac{2}{3}$rds chance of losing it. So her expected value = $latex \frac{1}{3}2x - \frac{2}{3}x = 0$. Therefore the entire strategy is fair, the gambler on average will not make or lose any money. Incidentally, this strategy of letting your winnings ride until you win a target amount or lose is sometimes called &quot;playing the martingale&quot;. If we now consider the total amount won or lost by the casino at any point in time then that too must have expectation zero, since each gambler is playing a fair game, so it the casino as a whole.</p>
<p>Here comes the big trick, when we say that the casino has expected gains of zero at <em>any</em> time, we really mean <em>any</em> time. Including random times like $latex T_{ABC}$ the first time the word ABC is typed or $latex T_{ABA}$ the first time the word ABA is typed. OK, we are almost there, all we need to do is calculate the expected gain by the casino at times $latex T_{ABC}$ and $latex T_{ABA}$ and we will be done. Let's do ABC first. The first time the monkey types ABC, all of the gamblers except the 3rd to last will have winnings of zero. The third to last will have winnings of $27. The total amount of wagered will be $latex T_{ABC}$. Mathematically, <br /><span class="math"><em>E</em>[<em>T</em><sub><em>A</em><em>B</em><em>C</em></sub> − 27] = 0</span><br /> expresses the fact that the expected profit of the casino must be zero. Hence, by the linearity of expectation, <br /><span class="math"><em>E</em>[<em>T</em><sub><em>A</em><em>B</em><em>C</em></sub>] = 27</span><br /></p>
<p>But what happens when we analyze the word ABA instead? At time $latex T_{ABA}$, not only has the third to last gambler 27 in winnings, but the last gambler has 3. Since she wagered one dollar on the event the monkey typed an A and the monkey did. Hence, <br /><span class="math"><em>E</em>[<em>T</em><sub><em>A</em><em>B</em><em>A</em></sub> − 27 − 3] = 0</span><br /> and <br /><span class="math"><em>E</em>[<em>T</em><sub><em>A</em><em>B</em><em>A</em></sub>] = 30</span><br /></p>
<h2 id="back-to-abracadabra">Back to ABRACADABRA</h2>
<p>It should now be straightforward to calculate the expected time it takes for the monkey to type ABRACADABRA and ABCDEFGHIJK. we simply compute how much money the casino has paid out the first time the monkey types the word. In the case of ABCDEFGHIJK the only winner is the gambler who started 11 keystrokes ago. She grosses $latex 26^11$ so the that's the epected time. But in the case of ABRACADABRA the gambler who started playing 4 keystrokes ago has winnings of $latex 26^4$ and the gambler who bet on the last keystroke won 26, hence for ABRACADABRA, <br /><span class="math"><em>E</em>[<em>T</em>] = 26<sup>11</sup> + 26<sup>4</sup> + 26</span><br /></p>
<h2 id="intuition">Intuition</h2>
<p>I don’t know about you, but this result is counter-intuitive to me. I expected it would take the same time on average, or if anything longer to type ABCDEFGHIJK since at the 8th keystroke the monkey types an A starting the sequence again. Here is where the simplified case using ABC and ABA can help us get a better grip on what is really going on. In these cases we can easily caculate some probabilities. Let's look at all of the winning strings after 5 keystrokes. We use * to mean any character in the alphabet.</p>
<pre><code>A B C * *
* A B C *
* * A B C</code></pre>
<p>If we want to know the probability that the monkey typed ABC in the first 5 strokes, we need to take the probability of the union of the three events above. By looking at the third character in each string, we can see that the three cases are mutually exclusive. Therefore, we can just add their probabilities. The probability of the first case is clearly $latex \frac{3^2}{3^5}$ so the probability of the union is $latex \frac{3^3}{3^5}=\frac{1}{9}$. In other words the probability that the monkey types ABC in 5 keystrokes or less. On the other hand for the ABA case we have</p>
<pre><code>A B A * *
* A B A *
* * A B A</code></pre>
<p>And again the probability of any row if $latex \frac{1}{27}$ but we can no longer add the three events since they are no longer mutually exclusive. We can see that the first and third case overlap, they both contain the sequence:</p>
<pre><code>A B A B A</code></pre>
<p>And that is the only string that they have in common. So by the inclusion - excluision principle we need to subtract that case out to get the probability as <br /><span class="math">$$\frac{27-1}{3^5}$$</span><br /> Which is lower by $latex \frac{1}{243}$rd. And now it becomes clear why the average time for the monkey to type a word is longer if the word has repeated sub-strings. That is for any given time the probability of typing the word with repeated sub-strings is lower so it takes longer on average to happen.</p>
<div class="references">

</div>
